---
import LayoutBase from '@components/layouts/Base/index.astro'
import PostTeaser from '@components/PostTeaser'
import { PhotoThumb } from '../components/layouts/Photos'
import { loadAndFormatCollection } from '@lib/astro'

const articles = await loadAndFormatCollection('articles')
const links = await loadAndFormatCollection('links')
const photos = await loadAndFormatCollection('photos')
---

<style>
  /* .section {
    composes: wide from '../components/Layout.module.css';
  } */

  .section:not(:first-child) {
    margin-top: calc(var(--spacer) * 3);
  }

  .articles,
  .photos {
    display: grid;
    gap: var(--spacer);
  }

  @media (min-width: 40rem) {
    .articles {
      gap: calc(var(--spacer) * 1.5);
      grid-template-columns: repeat(2, 1fr);
    }
  }

  .articles:first-of-type h1 {
    font-size: var(--font-size-h3);
  }

  .articlesLast {
    margin-top: calc(var(--spacer) * 1.5);
  }

  @media (min-width: 40rem) {
    .articlesLast {
      gap: calc(var(--spacer) * 1.5);
      grid-template-columns: repeat(3, 1fr);
    }
  }

  .photos {
    grid-template-columns: repeat(2, 1fr);
  }

  @media (min-width: 40rem) {
    .photos {
      gap: calc(var(--spacer) * 1.5);
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    }
  }
</style>

<LayoutBase>
  <section class="section">
    <div class="articles">
      {
        articles
          .slice(0, 2)
          .map((article) => <PostTeaser post={article} hideDate />)
      }
    </div>
    <div class="articles articlesLast">
      {
        articles
          .slice(2, 8)
          .map((article) => <PostTeaser post={article} hideDate />)
      }
    </div>

    <a href="/archive">All Articles</a>
  </section>

  <!-- <section class="section">
  <div class="photos">
    {photos.map(({ node }) => <PhotoThumb photo={node} />)}
  </div>

  <PostMore to="/photos">All Photos</PostMore>
</section> -->
</LayoutBase>
