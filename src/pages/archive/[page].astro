---
import { loadAndFormatCollection } from '@lib/astro'
import type { GetStaticPathsOptions, Page } from 'astro'
import type { CollectionEntry } from 'astro:content'
import LayoutArchive from '@components/layouts/Archive.astro'

type Props = {
  page: Page<CollectionEntry<'articles' | 'links'>>
}

export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
  const articles = await loadAndFormatCollection('articles')
  const links = await loadAndFormatCollection('links')
  return paginate([...articles, ...links], { pageSize: 30 })
}
// All paginated data + posts are passed on the "page" prop
const { page } = Astro.props
---

<LayoutArchive
  title="Archive"
  pageTitle={`Archive | Page ${page.currentPage} of ${page.lastPage} `}
  page={page}
/>
