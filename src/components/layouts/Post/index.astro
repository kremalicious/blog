---
import type { CollectionEntry } from 'astro:content'
import LayoutBase from '@layouts/Base/index.astro'
import Title from './Title.astro'
import Actions from './Actions.astro'
import styles from './index.module.css'
import Meta from './Meta.astro'
import Picture from '@components/core/Picture.astro'
import Toc from '@components/Toc/Toc.astro'

type Props = CollectionEntry<'articles' | 'links' | 'photos'> & {
  lead?: string // comes in through remark plugin as html
  tableOfContents?: string // comes in through remark plugin as html
}

const { data, collection, lead, tableOfContents } = Astro.props
const { title, date, updated, image, linkurl, toc, style, githubLink } = data
---

<LayoutBase title={title} style={style}>
  <article class={styles.entry}>
    <header>
      <Title linkurl={linkurl} title={title} date={date} updated={updated} />
    </header>

    {
      collection === 'articles' && lead && (
        <div class={styles.lead} set:html={lead} />
      )
    }

    {
      image && (
        <Picture
          class={styles.image}
          width={1040}
          height={460}
          image={image}
          alt={title}
        />
      )
    }

    {toc && tableOfContents && <Toc tableOfContents={tableOfContents} />}

    <slot />

    <Meta post={Astro.props} />
    {collection !== 'photos' && <Actions githubLink={githubLink as string} />}

    {
      /* <RelatedPosts isPhotos={collection === 'photos'} tags={tags as string[]} /> */
    }
    {/* <PrevNext prev={prev} next={next} /> */}
  </article>
</LayoutBase>
